(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{FUS3:function(n,e,t){"use strict";t.d(e,"a",(function(){return l}));var l=function(){return function(){}}()},RuDU:function(n,e,t){"use strict";t.r(e);var l=t("CcnG"),i=t("mrSG"),o=t("ZZ/e"),u=t("N+K7"),a=t("qfBg"),s=t("A3rM"),r=t("gRf5"),d=t("t8sF"),c=t("6m4Z"),h=t("eaQS"),p=t("wt5D"),f=function(){function n(n,e,t,l,i,o,u,a,s,r,d,c){this.nav=n,this.http=e,this.user=t,this.seletemedia=l,this.native=i,this.actionSheetController=o,this.file=u,this.activeroute=a,this.transfer=s,this.popoverController=r,this.route=d,this.modalController=c}return n.prototype.ngOnInit=function(){this.isseleteVedio=0,this.imgs=[],this.isshowend=!0},n.prototype.ionViewDidEnter=function(){var n=this;this.type=this.activeroute.snapshot.queryParams.type.toString(),this.addressObj=this.user.getLocation(),this.userdata=this.user.getUserp(),this.native.getStorage("pqcontent").then((function(e){e&&(n.content=e)})).catch((function(n){}))},n.prototype.goBack=function(){this.native.setStorage("pqcontent",this.content).then((function(n){})).catch((function(n){})),this.imgs=[],this.videofile=null,this.videofile1=null,this.nav.back()},n.prototype.ionViewDidLeave=function(){},n.prototype.addfm=function(){if(9===this.imgs.length)return!1;this.presentActionSheet()},n.prototype.remove=function(n){this.imgs.splice(n,1),8===this.imgs.length?this.isshowend=!0:0===this.imgs.length&&(this.isseleteVedio=0)},n.prototype.presentActionSheet=function(){return i.__awaiter(this,void 0,void 0,(function(){var n,e=this;return i.__generator(this,(function(t){switch(t.label){case 0:return n=[],1!=this.isseleteVedio&&n.push.apply(n,[{text:"相机",handler:function(){e.native.getPictureByCamera().then((function(n){e.addimgfn(n)}))}},{text:"相册",handler:function(){console.log("Share clicked"),e.native.getPictures(9-e.imgs.length).then((function(n){n.map((function(n){e.addimgfn(n)}))}),(function(n){}))}}]),2!=this.isseleteVedio&&n.push({text:"拍摄视频",role:"",handler:function(){e.native.captureVideo().then((function(n){e.isseleteVedio=1,e.videofile=n,e.videofile.getFormatData((function(n){e.videofile1=n}))}),(function(n){}))}},{text:"选择视频",role:"",handler:function(){e.native.getViedeo().then((function(n){e.isseleteVedio=1,e.seleteFilepath=n})).catch((function(n){}))}}),n.push({text:"取消",role:"cancel",handler:function(){console.log("Cancel clicked")}}),[4,this.actionSheetController.create({header:"请选择来源",buttons:n})];case 1:return[4,t.sent().present()];case 2:return t.sent(),[2]}}))}))},n.prototype.addimgfn=function(n){this.imgs.push(n),this.imgs.length>0&&(this.isseleteVedio=2),9===this.imgs.length&&(this.isshowend=!1)},n.prototype.contentsend=function(n){var e=this,t={img:JSON.stringify(n),type:1,address:this.address,lnglat:this.lnglat,content:this.content};this.http.postformdataloading(this.http.fbpqitem,t).subscribe((function(n){console.log(n),e.user.addjf(n.result.num),e.uploadEnd(),e.imgs.length=0,e.route.navigate(["/fbyjmore"],{queryParams:{type:1,num:n.result.num,sendnum:n.result.sendnum,lxb:n.result.lxb}}),e.native.removeStorage("pqcontent")}),(function(n){e.uploadEnd()}))},n.prototype.sub=function(){this.isloading=!0,this.subloading(),1==this.isseleteVedio?this.getVidefile():0===this.imgs.length?this.contentsend():this.basezfile()},n.prototype.getVidefile=function(){var n=this,e={name:"",type:"",width:null,height:null,path:null};if(!this.seleteFilepath)return!1;e.name="yj"+(new Date).getTime();var t=this.seleteFilepath.split(".");e.type="video/"+t[t.length-1],e.width=400,e.height=400,e.path=this.seleteFilepath,this.transfer.create().upload(e.path||this.videofile.fullPath,this.http.domain+this.http.updateimg,{fileName:e.name||this.videofile.name,fileKey:"file",chunkedMode:!1,mimeType:e.type||this.videofile.type,params:{width:e.width||.5*this.videofile1.width,height:e.height||.5*this.videofile1.height}}).then((function(e){n.videofile=null,n.videofile1=null,n.seleteFilepath=null;var t=JSON.parse(e.response);1==t.status?n.contentsend([t.result]):(n.native.presentToast(t.msg),n.uploadEnd())})).catch((function(e){n.native.presentToast("上传失败"),n.uploadEnd()}))},n.prototype.basezfile=function(){var n=this,e=[];this.imgs.map((function(t,l){var i=n.native.getImgbase64tofile(t,"pq"+l);e.push(n.imgupload(i))})),Promise.all(e).then((function(e){n.contentsend(e)})).catch((function(e){n.native.presentAlert("上传失败，请查看网络是否正常"),n.uploadEnd()}))},n.prototype.imgupload=function(n){var e=this;return new Promise((function(t,l){var i=new XMLHttpRequest;i.open("POST",e.http.domain+e.http.updateimg),i.onreadystatechange=function(n){if(4==i.readyState&&200==i.status){var e=JSON.parse(i.response);t(e.result)}},i.onerror=function(n){l(n)},i.send(n)}))},n.prototype.playvideo=function(){this.native.isandroid()&&this.native.nativeVideoplay(this.seleteFilepath||this.videofile.fullPath)},n.prototype.videoSet=function(){return i.__awaiter(this,void 0,void 0,(function(){var n,e=this;return i.__generator(this,(function(t){switch(t.label){case 0:return n=[],this.native.isandroid()&&n.push({text:"播放",role:"destructive",handler:function(){e.playvideo()}}),n.push.apply(n,[{text:"删除",handler:function(){e.videofile=null,e.videofile1=null,e.isseleteVedio=0,e.seleteFilepath=null}},{text:"取消",role:"cancel",handler:function(){console.log("Cancel clicked")}}]),[4,this.actionSheetController.create({header:"请选择操作",buttons:n})];case 1:return[4,t.sent().present()];case 2:return t.sent(),[2]}}))}))},n.prototype.uploadEnd=function(){return i.__awaiter(this,void 0,void 0,(function(){var n;return i.__generator(this,(function(e){switch(e.label){case 0:return this.isloading=!1,this.popoverController.dismiss(),[4,this.actionSheetController.getTop()];case 1:return(n=e.sent())&&n.dismiss(),[2]}}))}))},n.prototype.subloading=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(n){switch(n.label){case 0:return[4,this.popoverController.create({component:h.a,translucent:!1,cssClass:"payboxcontent",backdropDismiss:!1})];case 1:return[4,n.sent().present()];case 2:return n.sent(),[2]}}))}))},n.prototype.openMap=function(){return i.__awaiter(this,void 0,void 0,(function(){var n,e=this;return i.__generator(this,(function(t){switch(t.label){case 0:return[4,this.modalController.create({component:p.a})];case 1:return(n=t.sent()).onDidDismiss().then((function(n){console.log(n),n.data&&(e.address=n.data.address,e.lnglat=n.data.lnglat)})),[4,n.present()];case 2:return[2,t.sent()]}}))}))},n}(),g=function(){return function(){}}(),m=t("pMnS"),v=t("1Rjz"),b=t("3rJi"),C=t("ZYjt"),y=t("iQv9"),w=t("oBZk"),R=t("gIcY"),x=t("Ip0R"),_=t("ZYCi"),k=l["ɵcrt"]({encapsulation:0,styles:[['.img-box[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}.box[_ngcontent-%COMP%]{display:inline-block;position:relative;width:100%;float:left;font-size:12px;background-color:var(--ion-gray-background-color);border-radius:5px;overflow:hidden}.box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.box[_ngcontent-%COMP%]:before{content:"";display:block;padding-top:100%}.bf-box[_ngcontent-%COMP%]{width:100px;height:100px;border:1px solid var(--ion-color-light);display:flex;align-items:center;justify-content:center}.bf-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40%}.address-box[_ngcontent-%COMP%]{font-size:var(--ion-sm-text);color:var(--ion-color-medium)}']],data:{}});function E(n){return l["ɵvid"](0,[(n()(),l["ɵeld"](0,0,null,null,1,"app-pqimgbox",[],null,[[null,"clickItem"],[null,"addimgitem"]],(function(n,e,t){var l=!0,i=n.component;return"clickItem"===e&&(l=!1!==i.remove(t)&&l),"addimgitem"===e&&(l=!1!==i.addfm()&&l),l}),v.b,v.a)),l["ɵdid"](1,114688,null,0,b.a,[u.a,C.b,o.Jb,y.a,c.a],{imglist:[0,"imglist"],showend:[1,"showend"]},{clickItem:"clickItem",addimgitem:"addimgitem"})],(function(n,e){var t=e.component;n(e,1,0,t.imgs,t.isshowend)}),null)}function N(n){return l["ɵvid"](0,[(n()(),l["ɵeld"](0,0,null,null,1,"div",[["class","bf-box"]],null,[[null,"click"]],(function(n,e,t){var l=!0;return"click"===e&&(l=!1!==n.component.videoSet()&&l),l}),null,null)),(n()(),l["ɵeld"](1,0,null,null,0,"img",[["alt",""],["src","../../../assets/icon/play.svg"]],null,null,null,null,null))],null,null)}function D(n){return l["ɵvid"](0,[(n()(),l["ɵeld"](0,0,null,null,19,"ion-header",[["mode","ios"]],null,null,null,w.vb,w.s)),l["ɵdid"](1,49152,null,0,o.D,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{mode:[0,"mode"]},null),(n()(),l["ɵeld"](2,0,null,0,17,"ion-toolbar",[["mode","ios"]],null,null,null,w.fc,w.cb)),l["ɵdid"](3,49152,null,0,o.Eb,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{mode:[0,"mode"]},null),(n()(),l["ɵeld"](4,0,null,0,5,"ion-buttons",[["mode","ios"],["slot","start"]],null,null,null,w.jb,w.g)),l["ɵdid"](5,49152,null,0,o.n,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["ɵeld"](6,0,null,0,3,"ion-button",[],null,[[null,"click"]],(function(n,e,t){var l=!0;return"click"===e&&(l=!1!==n.component.goBack()&&l),l}),w.ib,w.f)),l["ɵdid"](7,49152,null,0,o.m,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["ɵeld"](8,0,null,0,1,"ion-icon",[["mode","ios"],["name","arrow-back"]],null,null,null,w.wb,w.t)),l["ɵdid"](9,49152,null,0,o.E,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{mode:[0,"mode"],name:[1,"name"]},null),(n()(),l["ɵeld"](10,0,null,0,2,"ion-title",[],null,null,null,w.dc,w.ab)),l["ɵdid"](11,49152,null,0,o.Cb,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["ɵted"](-1,0,["发布"])),(n()(),l["ɵeld"](13,0,null,0,6,"ion-buttons",[["slot","end"]],null,null,null,w.jb,w.g)),l["ɵdid"](14,49152,null,0,o.n,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["ɵeld"](15,0,null,0,4,"ion-button",[],null,[[null,"click"]],(function(n,e,t){var l=!0;return"click"===e&&(l=!1!==n.component.sub()&&l),l}),w.ib,w.f)),l["ɵdid"](16,49152,null,0,o.m,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{disabled:[0,"disabled"]},null),(n()(),l["ɵeld"](17,0,null,0,1,"ion-icon",[["name","paper-plane"]],null,null,null,w.wb,w.t)),l["ɵdid"](18,49152,null,0,o.E,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{name:[0,"name"]},null),(n()(),l["ɵted"](-1,0,["发表 "])),(n()(),l["ɵeld"](20,0,null,null,22,"ion-content",[["class","ion-padding"]],null,null,null,w.rb,w.o)),l["ɵdid"](21,49152,null,0,o.w,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["ɵeld"](22,0,null,0,8,"ion-textarea",[["placeholder","此刻你在哪里,分享下你的旅行心情吧~"],["rows","7"]],[[1,"maxlength",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionBlur"],[null,"ionChange"]],(function(n,e,t){var i=!0,o=n.component;return"ionBlur"===e&&(i=!1!==l["ɵnov"](n,25)._handleBlurEvent(t.target)&&i),"ionChange"===e&&(i=!1!==l["ɵnov"](n,25)._handleInputEvent(t.target)&&i),"ngModelChange"===e&&(i=!1!==(o.content=t)&&i),i}),w.bc,w.Y)),l["ɵdid"](23,540672,null,0,R.e,[],{maxlength:[0,"maxlength"]},null),l["ɵprd"](1024,null,R.g,(function(n){return[n]}),[R.e]),l["ɵdid"](25,16384,null,0,o.Rb,[l.ElementRef],null,null),l["ɵprd"](1024,null,R.h,(function(n){return[n]}),[o.Rb]),l["ɵdid"](27,671744,null,0,R.m,[[8,null],[6,R.g],[8,null],[6,R.h]],{model:[0,"model"]},{update:"ngModelChange"}),l["ɵprd"](2048,null,R.i,null,[R.m]),l["ɵdid"](29,16384,null,0,R.j,[[4,R.i]],null,null),l["ɵdid"](30,49152,null,0,o.Ab,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{maxlength:[0,"maxlength"],placeholder:[1,"placeholder"],rows:[2,"rows"]},null),(n()(),l["ɵand"](16777216,null,0,1,null,E)),l["ɵdid"](32,16384,null,0,x.NgIf,[l.ViewContainerRef,l.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),l["ɵand"](16777216,null,0,1,null,N)),l["ɵdid"](34,16384,null,0,x.NgIf,[l.ViewContainerRef,l.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),l["ɵeld"](35,0,null,0,7,"ion-list",[["class","ion-margin-top"]],null,null,null,w.Hb,w.D)),l["ɵdid"](36,49152,null,0,o.Q,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],null,null),(n()(),l["ɵeld"](37,0,null,0,5,"ion-item",[["button",""]],null,[[null,"click"]],(function(n,e,t){var l=!0;return"click"===e&&(l=!1!==n.component.openMap()&&l),l}),w.Eb,w.y)),l["ɵdid"](38,49152,null,0,o.J,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{button:[0,"button"]},null),(n()(),l["ɵeld"](39,0,null,0,1,"ion-icon",[["name","pin"],["slot","start"]],null,null,null,w.wb,w.t)),l["ɵdid"](40,49152,null,0,o.E,[l.ChangeDetectorRef,l.ElementRef,l.NgZone],{name:[0,"name"]},null),(n()(),l["ɵeld"](41,0,null,0,1,"span",[["class","address-box"]],null,null,null,null,null)),(n()(),l["ɵted"](42,null,["",""]))],(function(n,e){var t=e.component;n(e,1,0,"ios"),n(e,3,0,"ios"),n(e,9,0,"ios","arrow-back"),n(e,16,0,!t.content&&0==t.isseleteVedio),n(e,18,0,"paper-plane"),n(e,23,0,300),n(e,27,0,t.content),n(e,30,0,300,"此刻你在哪里,分享下你的旅行心情吧~","7"),n(e,32,0,1!=t.isseleteVedio),n(e,34,0,1==t.isseleteVedio),n(e,38,0,""),n(e,40,0,"pin")}),(function(n,e){var t=e.component;n(e,22,0,l["ɵnov"](e,23).maxlength?l["ɵnov"](e,23).maxlength:null,l["ɵnov"](e,29).ngClassUntouched,l["ɵnov"](e,29).ngClassTouched,l["ɵnov"](e,29).ngClassPristine,l["ɵnov"](e,29).ngClassDirty,l["ɵnov"](e,29).ngClassValid,l["ɵnov"](e,29).ngClassInvalid,l["ɵnov"](e,29).ngClassPending),n(e,42,0,t.address||"点击显示位置")}))}function V(n){return l["ɵvid"](0,[(n()(),l["ɵeld"](0,0,null,null,1,"app-fbpqimg",[],null,null,null,D,k)),l["ɵdid"](1,114688,null,0,f,[o.Kb,u.a,a.a,s.a,c.a,o.a,d.a,_.a,r.a,o.Nb,_.n,o.Jb],null,null)],(function(n,e){n(e,1,0)}),null)}var S=l["ɵccf"]("app-fbpqimg",f,V,{},{},[]),Z=t("hoFm"),I=t("iTUp"),M=t("FUS3"),P=t("j1ZV");t.d(e,"FbpqimgPageModuleNgFactory",(function(){return F}));var F=l["ɵcmf"](g,[],(function(n){return l["ɵmod"]([l["ɵmpd"](512,l.ComponentFactoryResolver,l["ɵCodegenComponentFactoryResolver"],[[8,[m.a,S]],[3,l.ComponentFactoryResolver],l.NgModuleRef]),l["ɵmpd"](4608,x.NgLocalization,x.NgLocaleLocalization,[l.LOCALE_ID,[2,x["ɵangular_packages_common_common_a"]]]),l["ɵmpd"](4608,R.s,R.s,[]),l["ɵmpd"](4608,o.c,o.c,[l.NgZone,l.ApplicationRef]),l["ɵmpd"](4608,o.Jb,o.Jb,[o.c,l.ComponentFactoryResolver,l.Injector]),l["ɵmpd"](4608,o.Nb,o.Nb,[o.c,l.ComponentFactoryResolver,l.Injector]),l["ɵmpd"](4608,Z.a,Z.a,[]),l["ɵmpd"](1073742336,x.CommonModule,x.CommonModule,[]),l["ɵmpd"](1073742336,R.r,R.r,[]),l["ɵmpd"](1073742336,R.d,R.d,[]),l["ɵmpd"](1073742336,o.Gb,o.Gb,[]),l["ɵmpd"](1073742336,I.a,I.a,[]),l["ɵmpd"](1073742336,M.a,M.a,[]),l["ɵmpd"](1073742336,P.a,P.a,[]),l["ɵmpd"](1073742336,_.p,_.p,[[2,_.u],[2,_.n]]),l["ɵmpd"](1073742336,g,g,[]),l["ɵmpd"](1024,_.l,(function(){return[[{path:"",component:f}]]}),[])])}))},hoFm:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var l=t("CcnG"),i=function(){function n(){}return n.prototype.getEmoji=function(){return"😀 😃 😄 😁 😆 😅 😂 🤣 😊 😇 🙂 🙃 😉 😌 😍 😘 😗 😙 😚 😋 😜 😝 😛 🤑 🤗 🤓 😎 🤡 🤠 😏 😒 😞 😔 😟 😕 🙁 ☹️ 😣 😖 😫 😩 😤 😠 😡 😶 😐 😑 😯 😦 😧 😮 😲 😵 😳 😱 😨 😰 😢 😥 🤤 😭 😓 😪 😴 🙄 🤔 🤥 😬 🤐 🤢 🤧 😷 🤒 🤕 😈 👿 👹 👺 💩 👻 💀 ☠️ 👽 👾 🤖 🎃 😺 😸 😹 😻 😼 😽 🙀 😿 😾 👐 🙌 👏 🙏 🤝 👍 👎 👊 ✊ 🤛 🤜 🤞 ✌️ 🤘 👌 👈 👉 👆 👇 ☝️ ✋ 🤚 🖐 🖖 👋 🤙 💪 🖕 ✍️ 🤳 💅 🖖 💄 💋 👄 👅 👂 👃 👣 👁 👀 🗣 👤 👥 👶 👦 👧 👨 👩 👱‍♀️ 👱 👴 👵 👲 👳‍♀️ 👳 👮‍♀️ 👮 👷‍♀️ 👷".split(" ")},n.ngInjectableDef=l["ɵɵdefineInjectable"]({factory:function(){return new n},token:n,providedIn:"root"}),n}()},iTUp:function(n,e,t){"use strict";t.d(e,"a",(function(){return l}));var l=function(){return function(){}}()},j1ZV:function(n,e,t){"use strict";t.d(e,"a",(function(){return l}));var l=function(){return function(){}}()},"n/qi":function(n,e,t){"use strict";t.d(e,"a",(function(){return l}));var l=function(){function n(){}return n.prototype.transform=function(n,e){return console.log(e),n?n.startsWith("http")||n.startsWith("data:image")||n.startsWith("file:///")||n.startsWith("cdvfile://")?n:n.startsWith("/mobile")&&e&&e.endsWith("mobile/")?e+n.substring(7):n.startsWith("./../")?e+n.substring(5):e+n:"../../assets/mrtx.png"},n}()}}]);